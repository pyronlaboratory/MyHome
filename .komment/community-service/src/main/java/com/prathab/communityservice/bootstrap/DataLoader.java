{"name":"DataLoader.java","path":"community-service/src/main/java/com/prathab/communityservice/bootstrap/DataLoader.java","content":{"structured":{"description":"A `DataLoader` class that acts as a Spring Boot command line runner. The class loads data into a `CommunityRepository` and a `CommunityAdminRepository`. It creates a new `Community` object with a unique ID, sets its name and district, saves it to the repository, and then persists an `admin` object to the repository and links it to the community. Finally, the class updates the community with the saved admin.","image":"<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"no\"?>\n<!DOCTYPE svg PUBLIC \"-//W3C//DTD SVG 1.1//EN\"\n \"http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd\">\n<!-- Generated by graphviz version 2.43.0 (0)\n -->\n<!-- Title: com.prathab.communityservice.bootstrap.DataLoader Pages: 1 -->\n<svg width=\"232pt\" height=\"93pt\"\n viewBox=\"0.00 0.00 232.00 93.00\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\">\n<g id=\"graph0\" class=\"graph\" transform=\"scale(1 1) rotate(0) translate(4 89)\">\n<title>com.prathab.communityservice.bootstrap.DataLoader</title>\n<!-- Node1 -->\n<g id=\"Node000001\" class=\"node\">\n<title>Node1</title>\n<g id=\"a_Node000001\"><a xlink:title=\" \">\n<polygon fill=\"#999999\" stroke=\"#666666\" points=\"224,-30 0,-30 0,0 224,0 224,-30\"/>\n<text text-anchor=\"start\" x=\"8\" y=\"-18\" font-family=\"Helvetica,sans-Serif\" font-size=\"10.00\">com.prathab.communityservice.bootstrap.</text>\n<text text-anchor=\"middle\" x=\"112\" y=\"-7\" font-family=\"Helvetica,sans-Serif\" font-size=\"10.00\">DataLoader</text>\n</a>\n</g>\n</g>\n<!-- Node2 -->\n<g id=\"Node000002\" class=\"node\">\n<title>Node2</title>\n<g id=\"a_Node000002\"><a xlink:title=\" \">\n<polygon fill=\"white\" stroke=\"#666666\" points=\"173,-85 51,-85 51,-66 173,-66 173,-85\"/>\n<text text-anchor=\"middle\" x=\"112\" y=\"-73\" font-family=\"Helvetica,sans-Serif\" font-size=\"10.00\">CommandLineRunner</text>\n</a>\n</g>\n</g>\n<!-- Node2&#45;&gt;Node1 -->\n<g id=\"edge1_Node000001_Node000002\" class=\"edge\">\n<title>Node2&#45;&gt;Node1</title>\n<g id=\"a_edge1_Node000001_Node000002\"><a xlink:title=\" \">\n<path fill=\"none\" stroke=\"#63b8ff\" d=\"M112,-55.65C112,-47.36 112,-37.78 112,-30.11\"/>\n<polygon fill=\"#63b8ff\" stroke=\"#63b8ff\" points=\"108.5,-55.87 112,-65.87 115.5,-55.87 108.5,-55.87\"/>\n</a>\n</g>\n</g>\n</g>\n</svg>\n","diagram":"digraph G {\n    label=\"com.prathab.communityservice.bootstrap.DataLoader\"\n    bgcolor=\"#151719\"\n    fontcolor=\"#ECEDED\"\n    splines=ortho\n    fontname=\"Courier New\"\n    edge [color=\"#26de81\"]\n    node [style=filled,color=\"#717D86\", shape=rectangle, fontname=\"Courier New\"];\n    \n}\n","items":[{"id":"cb30dca4-a4b9-b2bc-6b48-3273e7c1b43e","ancestors":[],"type":"function","description":"loads data into a Community and CommunityAdmin repository by persistings a community and an admin to the repository, updating the community with the saved admin, and saving the admin to the repository.","name":"DataLoader","code":"@Component\npublic class DataLoader implements CommandLineRunner {\n  private final CommunityRepository communityRepository;\n  private final CommunityAdminRepository communityAdminRepository;\n\n  public DataLoader(\n      CommunityRepository communityRepository,\n      CommunityAdminRepository communityAdminRepository) {\n    this.communityRepository = communityRepository;\n    this.communityAdminRepository = communityAdminRepository;\n  }\n\n  /**\n   * loads data.\n   */\n  @Override public void run(String... args) throws Exception {\n    loadData();\n  }\n\n  /**\n   * persists a community and an admin to the repository, updates the community with\n   * the saved admin, and saves the admin to the repository.\n   */\n  private void loadData() {\n    // Persist community to repo\n    var communityName = \"MyHome default community\";\n    var communityDistrict = \"MyHome default community district\";\n    var communityId = \"default-community-id-for-testing\";\n    var community = new Community();\n    community.setName(communityName);\n    community.setDistrict(communityDistrict);\n    community.setCommunityId(communityId);\n    var savedCommunity = communityRepository.save(community);\n\n    // Persist admin to repo\n    var communityAdmin = new CommunityAdmin();\n    var adminId = UUID.randomUUID().toString();\n    communityAdmin.setAdminId(adminId);\n    communityAdmin.getCommunities().add(savedCommunity);\n    var savedCommunityAdmin = communityAdminRepository.save(communityAdmin);\n\n    // Update community with the saved admin\n    savedCommunity.getAdmins().add(savedCommunityAdmin);\n    communityRepository.save(savedCommunity);\n  }\n}","location":{"start":34,"insert":27,"offset":" ","indent":0,"comment":{"start":26,"end":33}},"item_type":"class","length":46,"docLength":7},{"id":"6786239d-b9f7-d698-2645-eaff51f9090a","ancestors":["cb30dca4-a4b9-b2bc-6b48-3273e7c1b43e"],"type":"function","description":"loads data.","params":[],"usage":{"language":"java","code":"public class DataLoader implements CommandLineRunner {\n    private final CommunityRepository communityRepository;\n    private final CommunityAdminRepository communityAdminRepository;\n\n    public DataLoader(CommunityRepository communityRepository, \n                        CommunityAdminRepository communityAdminRepository) {\n        this.communityRepository = communityRepository;\n        this.communityAdminRepository = communityAdminRepository;\n    }\n\n    @Override public void run(String... args) throws Exception {\n        loadData();\n    }\n\n    private void loadData() {\n        // Persist community to repo\n        var communityName = \"MyHome default community\";\n        var communityDistrict = \"MyHome default community district\";\n        var communityId = \"default-community-id-for-testing\";\n        var community = new Community();\n        community.setName(communityName);\n        community.setDistrict(communityDistrict);\n        community.setCommunityId(communityId);\n        var savedCommunity = communityRepository.save(community);\n\n        // Persist admin to repo\n        var communityAdmin = new CommunityAdmin();\n        var adminId = UUID.randomUUID().toString();\n        communityAdmin.setAdminId(adminId);\n        communityAdmin.getCommunities().add(savedCommunity);\n        var savedCommunityAdmin = communityAdminRepository.save(communityAdmin);\n\n        // Update community with the saved admin\n        savedCommunity.getAdmins().add(savedCommunityAdmin);\n        communityRepository.save(savedCommunity);\n    }\n}\n","description":"\nIn this example, the method `run` is being overridden to call the private method `loadData`. The purpose of this class is to load data into a Community and CommunityAdmin repository, so it uses the `communityRepository` and `communityAdminRepository` objects provided in its constructor. The method `loadData` persists a community to the repository and then persists an admin to the repository and links them to the community. Finally, the method updates the community with the saved admin."},"name":"run","code":"@Override public void run(String... args) throws Exception {\n    loadData();\n  }","location":{"start":49,"insert":46,"offset":" ","indent":2,"comment":{"start":45,"end":48}},"item_type":"method","length":3,"docLength":3},{"id":"9e26edcf-904b-27bd-fa43-1367172b8e80","ancestors":["cb30dca4-a4b9-b2bc-6b48-3273e7c1b43e"],"type":"function","description":"persistently creates and links a new community and its admin to the repository, updates the community with the saved admin, and saves both entities to the database.","params":[],"usage":{"language":"java","code":"public static void main(String[] args) {\n\t// Create a new DataLoader object\n\tvar dataLoader = new DataLoader(new CommunityRepository(), new CommunityAdminRepository());\n\t\n\t// Run the loadData method\n\tdataLoader.loadData();\n}\n","description":"\nIn this example, we create an instance of `DataLoader` and then call its `loadData()` method to execute the code in the method. The method persists a community and an admin to the repository, updates the community with the saved admin, and saves the admin to the repository."},"name":"loadData","code":"private void loadData() {\n    // Persist community to repo\n    var communityName = \"MyHome default community\";\n    var communityDistrict = \"MyHome default community district\";\n    var communityId = \"default-community-id-for-testing\";\n    var community = new Community();\n    community.setName(communityName);\n    community.setDistrict(communityDistrict);\n    community.setCommunityId(communityId);\n    var savedCommunity = communityRepository.save(community);\n\n    // Persist admin to repo\n    var communityAdmin = new CommunityAdmin();\n    var adminId = UUID.randomUUID().toString();\n    communityAdmin.setAdminId(adminId);\n    communityAdmin.getCommunities().add(savedCommunity);\n    var savedCommunityAdmin = communityAdminRepository.save(communityAdmin);\n\n    // Update community with the saved admin\n    savedCommunity.getAdmins().add(savedCommunityAdmin);\n    communityRepository.save(savedCommunity);\n  }","location":{"start":57,"insert":53,"offset":" ","indent":2,"comment":{"start":52,"end":56}},"item_type":"method","length":22,"docLength":4}]}}}